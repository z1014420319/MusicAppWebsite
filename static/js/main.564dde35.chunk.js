(window.webpackJsonpagaintest=window.webpackJsonpagaintest||[]).push([[0],{142:function(e,t,a){e.exports=a(263)},147:function(e,t,a){},157:function(e,t){},159:function(e,t){},195:function(e,t){},196:function(e,t){},263:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(34),s=a.n(l),i=(a(147),a(5)),o=a(4),c=a(6),u=a(7),p=a(8),m=a(41),y=a(125),d=a(44),h=a(13);function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var v={myPlaylists:{"\u6700\u8fd1\u64ad\u653e":[]},commonLists:{"\u641c\u7d22":[]},searchList:[],loding:!1};function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var O={userName:"",online:!0,currentPlayList:"\u6700\u8fd1\u64ad\u653e",currentPlaying:{},musicDuration:0,currentNav:"",currentPlayMode:"loop"};function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var j={loading:!1,loadingmusic:!1},C=a(30),M=a.n(C),w=Object(m.c)({UserInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER_NAME":return g({},e,{userName:t.payload,online:!0});case"REMOVE_USER_NAME":return g({},e,{userName:""});case"SET_OFFLINE":return g({},e,{online:!1});case"SET_CURRENT_PLAYLIST":return g({},e,{currentPlayList:t.payload});case"SET_CURRENT_PLAYING":return g({},e,{currentPlaying:t.payload});case"SET_MUSIC_DURATION":return g({},e,{musicDuration:t.payload});case"SET_CURRENT_NAV":return g({},e,{currentNav:t.payload});case"SET_USER_INFO":return t.payload?(t.payload.online=!0,t.payload):g({},O,{userName:e.userName});case"SET_PLAY_MODE":return g({},e,{currentPlayMode:t.payload});default:return e}},MusicInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LODING_PLAYLISTS":return P({},e,{loding:!0});case"SET_PLAYLISTS":return P({},e,{loding:!1,myPlaylists:[].concat(Object(d.a)(e.myPlaylists),[t.payload])});case"CREATE_PLAYLIST":return P({},e,{myPlaylists:P({},e.myPlaylists,Object(h.a)({},t.payload,[]))});case"DELETE_PLAYLIST":var a=JSON.parse(JSON.stringify(e));return delete a.myPlaylists[t.payload],a;case"ADD_MUSIC_TO_PLAYLIST":var n=JSON.parse(JSON.stringify(e));return n.myPlaylists[t.payload.playlistname].push(t.payload.musicObj),n;case"DELETE_MUSIC_FROM_PLAYLIST":var r=JSON.parse(JSON.stringify(e)),l=r.myPlaylists[t.payload.playlistname].findIndex(function(e){return e.url===t.payload.musicObj.url});return r.myPlaylists[t.payload.playlistname].splice(l,1),r;case"SET_COMMON_LISTS":case"SET_SEARCH_LIST":return P({},e,{commonLists:Object.assign({},e.commonLists,t.payload)});case"SET_MUSIC_INFO":return t.payload?t.payload:v;default:return e}},UI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOADING_UI":return S({},e,{loading:!0});case"STOP_LOADING_UI":return S({},e,{loading:!1});case"LOADING_MUSIC":return S({},e,{loadingmusic:!0});case"STOP_LOADING_MUSIC":return S({},e,{loadingmusic:!1});default:return e}}}),N={};if(window.localStorage.MusicApp)try{var I=M.a.verify(window.localStorage.MusicApp,"MusicApp").body.stores;for(var L in N=I.offline,I)if("offline"!==L&&I[L].UserInfo.online){N=I[L];break}}catch(dt){console.dir(dt)}var T="object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):m.d,_=[y.a],k=T(m.a.apply(void 0,_)),D=Object(m.e)(w,N,k),U=a(10),A=a(12),R=a(37),F=a(40),V=a.n(F),x=function(e){return function(t){t({type:"CREATE_PLAYLIST",payload:e})}},Y=function(e,t){return function(a){a({type:"ADD_MUSIC_TO_PLAYLIST",payload:{musicObj:e,playlistname:t}})}},G=function(e,t){return function(a){a({type:"DELETE_MUSIC_FROM_PLAYLIST",payload:{musicObj:e,playlistname:t}})}},X=function(e,t){return function(a){if(!t&&"\u641c\u7d22"!==e){var n=[],r=Object(h.a)({},e,[]);a({type:"SET_COMMON_LISTS",payload:r}),a({type:"LOADING_UI"}),a({type:"LOADING_MUSIC"});for(var l=0;l<1;l++)n.push(V.a.get("https://api.uomg.com/api/rand.music?sort="+e+"&format=json"));Promise.all(n).then(function(t){var n=!0,l=!1,s=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value;r[e].push(c.data.data)}}catch(dt){l=!0,s=dt}finally{try{n||null==o.return||o.return()}finally{if(l)throw s}}a({type:"SET_COMMON_LISTS",payload:r}),a({type:"STOP_LOADING_MUSIC"})}).catch(function(e){return console.dir(e)})}}},J=function(e){return function(t){t({type:"LOADING_MUSIC"}),V.a.get("https://api.apiopen.top/searchMusic?name="+e).then(function(e){var a=e.data.result.map(function(e){return{artistsname:e.author,name:e.title,picurl:e.pic,url:e.url}});t({type:"SET_SEARCH_LIST",payload:{"\u641c\u7d22":a}}),t({type:"STOP_LOADING_MUSIC"})})}},H={getSearchList:J},q=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),a.state.searchValue&&(a.props.getSearchList(a.state.searchValue),a.props.history.push("/list/\u641c\u7d22?"+a.state.searchValue,null),a.setState({searchValue:""}))},a.handleChange=function(e){a.setState({searchValue:e.target.value})},a.state={searchValue:""},a.search=r.a.createRef(),a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e="";switch(/\u641c\u7d22/.test(this.props.location.pathname)){case!1:e="hidden";break;case!0:e="visible"}return r.a.createElement(r.a.Fragment,null,r.a.createElement("nav",null,r.a.createElement(A.c,{activeClassName:"nav-selected",to:"/list/\u70ed\u6b4c\u699c"},"\u70ed\u6b4c\u699c"),r.a.createElement(A.c,{activeClassName:"nav-selected",to:"/list/\u65b0\u6b4c\u699c"},"\u65b0\u6b4c\u699c"),r.a.createElement(A.c,{activeClassName:"nav-selected",to:"/list/\u6296\u97f3\u699c"},"\u6296\u97f3\u699c"),r.a.createElement(A.c,{activeClassName:"nav-selected",to:"/list/\u7535\u97f3\u699c"},"\u7535\u97f3\u699c"),r.a.createElement(A.c,{activeClassName:"nav-selected",to:"/list/\u641c\u7d22"},"\u641c\u7d22")),r.a.createElement("form",{onSubmit:this.handleSubmit,style:{visibility:e}},r.a.createElement("input",{ref:this.search,type:"text",value:this.state.searchValue,onChange:this.handleChange})))}},{key:"componentDidUpdate",value:function(){this.search.current.focus()}}]),t}(n.Component),W=Object(U.b)(null,H)(Object(R.g)(q)),B=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,"OPRATE"===this.props.type?r.a.createElement("button",{className:"opration","data-url":this.props.musicObj.url,onClick:this.props.handleShowPlaylist},"\xb7 \xb7 \xb7"):r.a.createElement("button",{"data-url":this.props.musicObj.url,onClick:this.props.handleDeleteMusicFromPlaylist},"X"))}}]),t}(n.Component);function z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var K,Q=function(){var e={};if(window.localStorage.MusicApp)try{e=M.a.verify(window.localStorage.MusicApp,"MusicApp").body.stores}catch(dt){}e[D.getState().UserInfo.userName||"offline"]=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?z(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):z(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},D.getState());var t={stores:e},a=M.a.create(t,"MusicApp");a.setExpiration();var n=a.compact();window.localStorage.removeItem("MusicApp"),window.localStorage.setItem("MusicApp",n)},Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(a){Q(),a({type:"SET_USER_NAME",payload:e}),a({type:"SET_MUSIC_INFO",payload:t.MusicInfo}),a({type:"SET_USER_INFO",payload:t.UserInfo})}},$=function(e){return function(t){t({type:"SET_CURRENT_PLAYLIST",payload:e})}},ee=function(e){return function(t){t({type:"SET_CURRENT_PLAYING",payload:e})}},te={setCurrentPlaying:ee,setCurrentPlayList:$,addMusciToPlaylist:Y,imageLoadEnd:function(){return function(e){e({type:"STOP_LOADING_UI"})}}},ae=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).listenMusic=function(e){var t=a.props.currentNav;["\u70ed\u6b4c\u699c","\u65b0\u6b4c\u699c","\u6296\u97f3\u699c","\u7535\u97f3\u699c","\u641c\u7d22"].includes(a.props.currentNav)&&(t="\u6700\u8fd1\u64ad\u653e",!a.props.myPlaylists[t].some(function(e){return e.url===a.props.musicObj.url})&&a.props.addMusciToPlaylist(a.props.musicObj,t)),t!==a.props.currentPlayList&&a.props.setCurrentPlayList(t),a.props.musicObj.url!==a.props.currentPlaying.url&&a.props.setCurrentPlaying(a.props.musicObj);var n=document.querySelector("audio");n.paused&&n.play()},a.handleLoad=function(e){a.props.imageLoadEnd()},a.state={},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e={};return this.props.musicObj.url===this.props.currentPlaying.url&&(e.color="red"),r.a.createElement("li",{style:e,onClick:this.listenMusic,"data-access":"item"},r.a.createElement(B,this.props),"display"===this.props.listType&&r.a.createElement("img",{alt:"",onLoad:this.handleLoad,src:this.props.musicObj.picurl}),r.a.createElement("span",{"data-access":"item"},this.props.musicObj.name," - ",this.props.musicObj.artistsname))}}]),t}(n.Component),ne=Object(R.g)(Object(U.b)(function(e){return{currentPlayList:e.UserInfo.currentPlayList,currentPlaying:e.UserInfo.currentPlaying,myPlaylists:e.MusicInfo.myPlaylists}},te)(ae)),re=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t="";return/list/.test(this.props.location.pathname)&&!/\u641c\u7d22/.test(this.props.location.pathname)?t+="display":t+="list",r.a.createElement("ul",{className:t},this.props.commonLists[this.props.currentNav].map(function(a,n){return r.a.createElement(ne,{listType:t,key:n,musicObj:a,handleShowPlaylist:e.props.handleShowPlaylist,type:e.props.type,handleDeleteMusicFromPlaylist:e.props.handleDeleteMusicFromPlaylist,currentNav:e.props.currentNav})}),0===this.props.commonLists[this.props.currentNav].length&&r.a.createElement("div",{className:"empty"},"\u5217\u8868\u4e3a\u7a7a"))}}]),t}(n.Component),le=Object(R.g)(re),se={setCurrentPlaying:ee,setCurrentPlayList:$},ie=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handlePlay=function(e){a.props.myPlaylists[e.target.parentNode.dataset.playlistname].length>0?(a.props.setCurrentPlayList(e.target.parentNode.dataset.playlistname),a.props.setCurrentPlaying(a.props.myPlaylists[e.target.parentNode.dataset.playlistname][0]),document.querySelector("audio").play()):alert("\u5217\u8868\u4e3a\u7a7a")},a.state={},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return"VIEW"===this.props.type?r.a.createElement("span",{className:"playlistopration","data-playlistname":this.props.playlistname},"\u6700\u8fd1\u64ad\u653e"!==this.props.playlistname&&r.a.createElement("button",{onClick:this.props.handleDeletePlaylist},"\u5220\u9664"),r.a.createElement("button",{onClick:this.handlePlay},"\u64ad\u653e")):r.a.createElement("span",{className:"playlistopration","data-playlistname":this.props.playlistname},r.a.createElement("input",{type:"checkbox",checked:this.props.includes,onChange:this.props.handleCheckChange}))}}]),t}(n.Component),oe=Object(U.b)(function(e){return{myPlaylists:e.MusicInfo.myPlaylists}},se)(ie),ce=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e={};return this.props.currentPlayList===this.props.playlistname&&(e.color="red"),r.a.createElement("li",null,r.a.createElement(oe,{playlistname:this.props.playlistname,handleDeletePlaylist:this.props.handleDeletePlaylist,type:this.props.type,includes:this.props.includes,handleCheckChange:this.props.handleCheckChange}),r.a.createElement("span",{style:e,onClick:this.props.handleViewPlaylist},this.props.playlistname))}}]),t}(n.Component),ue=Object(U.b)(function(e){return{currentPlayList:e.UserInfo.currentPlayList}},null)(ce),pe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",{className:"playlist"},Object.keys(this.props.myPlaylists).map(function(t,a){return r.a.createElement(ue,{key:a,playlistname:t,handleDeletePlaylist:e.props.handleDeletePlaylist,handleViewPlaylist:e.props.handleViewPlaylist,type:e.props.type,includes:"OPRATE"===e.props.type&&e.props.myPlaylists[t].some(function(t){return t.url===e.props.currentMusicUrl}),handleCheckChange:e.props.handleCheckChange})})))}}]),t}(n.Component),me=a(280),ye=a(128),de=a.n(ye),he=a(129),fe=a.n(he),Pe={createPlaylist:x,addMusciToPlaylist:Y,deleteMusicFromPlaylist:G,getCommonLists:X,setCurrentPlaying:ee},ve=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleCreatePlaylist=function(e){if(a.props.userName){var t=window.prompt("\u540d\u79f0");if(a.props.myPlaylists.hasOwnProperty(t))alert("\u8be5\u5217\u8868\u540d\u79f0\u5df2\u5b58\u5728");else{if(!t)return;a.props.createPlaylist(t)}}else alert("\u8bf7\u5148\u767b\u5f55")},a.handleShowPlaylist=function(e){e.stopPropagation(),a.setState({showPlaylist:!0,currentMusicUrl:e.target.dataset.url})},a.handleHidePlaylist=function(e){a.setState({showPlaylist:!1,currentMusicUrl:""})},a.handleCheckChange=function(e){var t=a.props.commonLists[a.props.currentNav].find(function(e){return e.url===a.state.currentMusicUrl});e.target.checked?(a.props.addMusciToPlaylist(t,e.target.parentElement.dataset.playlistname),0===a.props.myPlaylists[a.props.currentPlayList].length&&0===Object.keys(a.props.currentPlaying).length&&a.props.setCurrentPlaying(t)):a.props.deleteMusicFromPlaylist(t,e.target.parentElement.dataset.playlistname)},a.handlerReload=function(e){a.props.loading||(a.setState({showPlaylist:!1}),a.props.getCommonLists(a.props.currentNav,!1))},a.clearSearchResult=function(e){a.props.commonLists["\u641c\u7d22"]=[],a.forceUpdate()},a.state={showPlaylist:!1,currentMusicUrl:"",currentNav:a.props.currentNav},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"title"},this.props.currentNav),"\u641c\u7d22"!==this.props.currentNav?r.a.createElement("div",{className:"listbutton refreah",onClick:this.handlerReload},this.props.loading?r.a.createElement(me.a,{size:"1.5rem"}):r.a.createElement(de.a,null)):r.a.createElement("div",{className:"listbutton clear",onClick:this.clearSearchResult},r.a.createElement(fe.a,null)),this.state.showPlaylist?r.a.createElement("div",null,r.a.createElement("div",{className:"buttongroup"},r.a.createElement("button",{onClick:this.handleHidePlaylist},"<\u8fd4\u56de"),r.a.createElement("button",{onClick:this.handleCreatePlaylist},"\u521b\u5efa\u64ad\u653e\u5217\u8868")),r.a.createElement(pe,{myPlaylists:this.props.myPlaylists,type:"OPRATE",currentMusicUrl:this.state.currentMusicUrl,handleCheckChange:this.handleCheckChange})):this.props.loadingmusic?r.a.createElement("div",{className:"loadingmusic"},r.a.createElement(me.a,null)):r.a.createElement(le,{handleShowPlaylist:this.handleShowPlaylist,commonLists:this.props.commonLists,currentNav:this.props.currentNav,type:"OPRATE"}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.currentNav!==t.currentNav?{currentNav:e.currentNav,showPlaylist:!1}:null}}]),t}(n.Component),be=Object(U.b)(function(e){return{commonLists:e.MusicInfo.commonLists,currentNav:e.UserInfo.currentNav,myPlaylists:e.MusicInfo.myPlaylists,userName:e.UserInfo.userName,currentPlayList:e.UserInfo.currentPlayList,currentPlaying:e.UserInfo.currentPlaying,loading:e.UI.loading,loadingmusic:e.UI.loadingmusic}},Pe)(ve),ge={getSearchList:J,setCurrentNav:function(e,t){return function(a){t||a({type:"SET_CURRENT_NAV",payload:e})}},getCommonLists:X},Oe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).count=0,a.state={},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.commonLists!==this.props.commonLists&&e.currentNav===this.props.currentNav}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(W,null),r.a.createElement(be,null))}},{key:"getSnapshotBeforeUpdate",value:function(e,t){return null}},{key:"componentDidUpdate",value:function(e,t,a){}},{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.location.pathname.match(/^\/list\/([^?]+)/);return a=a&&["\u70ed\u6b4c\u699c","\u65b0\u6b4c\u699c","\u6296\u97f3\u699c","\u7535\u97f3\u699c","\u641c\u7d22"].includes(a[1])?a[1]:"\u70ed\u6b4c\u699c",e.getCommonLists(a,e.currentNav===a||e.commonLists.hasOwnProperty(a)),e.setCurrentNav(a,e.currentNav===a),{}}}]),t}(n.Component),Ee=Object(U.b)(function(e){return{commonLists:e.MusicInfo.commonLists,currentNav:e.UserInfo.currentNav}},ge)(Oe),Se=a(131),je=a.n(Se),Ce=a(134),Me=a.n(Ce),we=a(132),Ne=a.n(we),Ie=a(133),Le=a.n(Ie),Te=a(130),_e=a.n(Te),ke=a(135),De=a.n(ke),Ue=a(136),Ae=a.n(Ue),Re=a(137),Fe=a.n(Re),Ve={addMusciToPlaylist:Y,deleteMusicFromPlaylist:G,setPlayMode:function(e){return function(t){t({type:"SET_PLAY_MODE",payload:e})}},setCurrentPlaying:ee,createPlaylist:x},xe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleCheckChange=function(e){a.state.noMusic||(e.target.checked?a.props.addMusciToPlaylist(a.props.currentPlaying,e.target.parentElement.dataset.playlistname):a.props.deleteMusicFromPlaylist(a.props.currentPlaying,e.target.parentElement.dataset.playlistname))},a.handleDeleteMusicFromPlaylist=function(e){if(!a.state.noMusic){e.stopPropagation();var t=a.props.myPlaylists[a.props.currentPlayList].find(function(t){return t.url===e.target.dataset.url});a.props.deleteMusicFromPlaylist(t,a.props.currentPlayList)}},a.handleShowPlaylist=function(e){e.stopPropagation(),a.setState({showPlaylist:!a.state.showPlaylist})},a.showMusiclist=function(e){a.setState({showMusiclist:!a.state.showMusiclist}),a.setState({showPlaylist:!1})},a.play=function(){a.state.noMusic||(a.setState({paused:!1}),a.props.audio.current.play(),a.handleSetInterval())},a.pause=function(){a.state.noMusic||(a.setState({paused:!0}),a.props.audio.current.pause(),a.handleClearInterval())},a.clickPlayer=function(){a.state.noMusic||(a.state.paused?a.play():a.pause())},a.setPlayMode=function(e){for(var t=e.target;"DIV"!==t.tagName;)t=t.parentNode;a.props.setPlayMode(t.dataset.changetomode)},a.previousMusic=function(e){if(!a.state.noMusic){if(a.state.noMusicInPlaylist)return a.props.audio.current.currentTime=0,void a.play();a.handleClearInterval();var t="",n=0;switch(a.props.currentPlayMode){case"random":t=a.props.myPlaylists[a.props.currentPlayList],n=Math.floor(Math.random()*t.length),a.props.setCurrentPlaying(t[n]),a.props.audio.current.currentTime=0,a.play();break;default:n=(t=a.props.myPlaylists[a.props.currentPlayList]).findIndex(function(e){return e.url===a.props.currentPlaying.url}),a.props.setCurrentPlaying(t[(n+t.length-1)%t.length]),a.props.audio.current.currentTime=0,a.play()}}},a.nextMusic=function(e){if(!a.state.noMusic){if(a.state.noMusicInPlaylist)return a.props.audio.current.currentTime=0,void a.play();a.handleClearInterval();var t="",n=0;switch(a.props.currentPlayMode){case"random":t=a.props.myPlaylists[a.props.currentPlayList],n=Math.floor(Math.random()*t.length),a.props.setCurrentPlaying(t[n]),a.props.audio.current.currentTime=0,a.play();break;default:n=(t=a.props.myPlaylists[a.props.currentPlayList]).findIndex(function(e){return e.url===a.props.currentPlaying.url}),a.props.setCurrentPlaying(t[(n+1)%t.length]),a.props.audio.current.currentTime=0,a.play()}}},a.clickedMusicItem=function(e){"item"===e.target.dataset.access&&(a.setState({paused:!1}),a.handleSetInterval())},a.handleCreatePlaylist=function(e){if(a.props.userName){var t=window.prompt("\u540d\u79f0");if(a.props.myPlaylists.hasOwnProperty(t))alert("\u8be5\u5217\u8868\u540d\u79f0\u5df2\u5b58\u5728");else{if(!t)return;a.props.createPlaylist(t)}}else alert("\u8bf7\u5148\u767b\u5f55")},a.handleTouchStart=function(e){e.target.style.transform="scale(1.5)",a.handleClearInterval(),a.setState({pageX:e.targetTouches[0].pageX,iniCurrentTime:a.state.currentTime})},a.handleTouchMove=function(e){if(!a.state.noMusic){var t=a.state.iniCurrentTime+(e.targetTouches[0].pageX-a.state.pageX)/300*a.props.musicDuration;t<=a.props.musicDuration&&t>=0&&a.setState({currentTime:t})}},a.handleTouchEnd=function(e){e.target.style.transform="scale(1)",a.state.noMusic||(a.setState({pageX:0,iniCurrentTime:0}),a.props.audio.current.currentTime=a.state.currentTime,a.state.paused||a.play())},a.state={showPlaylist:!1,showMusiclist:!1,paused:!0,currentTime:0,pageX:0,iniCurrentTime:0,noMusic:!1,noMusicInPlaylist:!1},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"handleClearInterval",value:function(){cancelAnimationFrame(this.interval)}},{key:"handleSetInterval",value:function(){var e=this;this.handleClearInterval();!function t(){e.setState({currentTime:e.props.audio.current.currentTime,paused:e.props.audio.current.paused}),e.interval=window.requestAnimationFrame(t)}()}},{key:"convertSecond",value:function(e){var t=String(Math.floor(e/60)),a=String(Math.round(e%60));return t<10&&(t="0"+t),a<10&&(a="0"+a),t+":"+a}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"controller"},r.a.createElement("div",{onClick:this.showMusiclist},r.a.createElement(_e.a,null)),r.a.createElement("div",{onClick:this.previousMusic},r.a.createElement(je.a,null)),this.state.paused?r.a.createElement("div",{onClick:this.play},r.a.createElement(Ne.a,null)):r.a.createElement("div",{onClick:this.pause},r.a.createElement(Le.a,null)),r.a.createElement("div",{onClick:this.nextMusic},r.a.createElement(Me.a,null)),"loop"===this.props.currentPlayMode&&r.a.createElement("div",{"data-changetomode":"random",onClick:this.setPlayMode},r.a.createElement(De.a,null)),"list"===this.props.currentPlayMode&&r.a.createElement("div",{"data-changetomode":"loop",onClick:this.setPlayMode},r.a.createElement(Ae.a,null)),"random"===this.props.currentPlayMode&&r.a.createElement("div",{"data-changetomode":"list",onClick:this.setPlayMode},r.a.createElement(Fe.a,null))),r.a.createElement("div",{className:"title"},r.a.createElement("div",{className:"process"},r.a.createElement("div",{className:"currenttime",style:{width:this.state.currentTime/this.props.musicDuration*300||0}},r.a.createElement("div",{className:"circle",onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd})),r.a.createElement("div",{className:"digitaltime"},this.convertSecond(this.state.currentTime)+"/"+this.convertSecond(this.props.musicDuration)))),!this.state.showMusiclist&&!this.state.showPlaylist&&r.a.createElement("div",{className:"player",onClick:this.clickPlayer},r.a.createElement("img",{alt:"",src:this.props.currentPlaying.picurl}),r.a.createElement("span",{style:{color:"red"}},this.props.currentPlaying.name," - ",this.props.currentPlaying.artistsname),r.a.createElement(B,{type:"OPRATE",musicObj:this.props.currentPlaying,handleShowPlaylist:this.handleShowPlaylist})),this.state.showMusiclist&&r.a.createElement("div",{onClickCapture:this.clickedMusicItem},r.a.createElement("button",{style:{margin:"0 auto",display:"block"},onClick:this.showMusiclist},"<\u8fd4\u56de"),r.a.createElement(le,{type:"DELETE",commonLists:this.props.myPlaylists,currentNav:this.props.currentPlayList,handleDeleteMusicFromPlaylist:this.handleDeleteMusicFromPlaylist})),this.state.showPlaylist&&r.a.createElement("div",null,r.a.createElement("div",{className:"buttongroup"},r.a.createElement("button",{onClick:this.handleShowPlaylist},"<\u8fd4\u56de"),r.a.createElement("button",{onClick:this.handleCreatePlaylist},"\u521b\u5efa\u64ad\u653e\u5217\u8868")),r.a.createElement(pe,{myPlaylists:this.props.myPlaylists,type:"OPRATE",currentMusicUrl:this.props.currentPlaying.url,handleCheckChange:this.handleCheckChange})))}},{key:"componentDidMount",value:function(){this.setState({paused:this.props.audio.current.paused,currentTime:this.props.audio.current.currentTime}),this.handleSetInterval()}},{key:"componentWillUnmount",value:function(){this.handleClearInterval()}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(0===Object.keys(e.currentPlaying).length){if(0===e.myPlaylists[e.currentPlayList].length)return{noMusic:!0}}else if(0===e.myPlaylists[e.currentPlayList].length)return{noMusicInPlaylist:!0};return null}}]),t}(n.Component),Ye=Object(U.b)(function(e){return{currentPlayList:e.UserInfo.currentPlayList,currentPlaying:e.UserInfo.currentPlaying,currentPlayMode:e.UserInfo.currentPlayMode,myPlaylists:e.MusicInfo.myPlaylists,musicDuration:e.UserInfo.musicDuration,userName:e.UserInfo.userName}},Ve)(Object(R.g)(xe)),Ge={login:Z},Xe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){a.setState({loading:!0}),e.preventDefault();var t=new FormData;t.append("apikey","84fa40e600ae8a00c47eaf282d3bda46"),t.append("passwd",a.state.password),t.append("name",a.state.mobile),V.a.post("https://api.apiopen.top/loginUser",t).then(function(e){if(200===e.data.code){var t={};if(window.localStorage.MusicApp)try{t=M.a.verify(window.localStorage.MusicApp,"MusicApp").body.stores[e.data.result.name]||{}}catch(dt){console.dir(dt)}a.props.login(e.data.result.name,t)}else a.setState({error_message:e.data.message,loading:!1})}).catch(function(e){return console.dir(e)}).finally(function(){document.querySelector("audio").pause()})},a.handleChange=function(e){var t;a.setState((t={},Object(h.a)(t,e.target.name,e.target.value),Object(h.a)(t,"error_message",""),t))},a.state={mobile:"",password:"",error_message:"",loading:!1},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"accountopration"},r.a.createElement(A.c,{to:"/my/collection"},"<\u8fd4\u56de"),r.a.createElement("div",null,"\u767b\u9646")),r.a.createElement("form",{onSubmit:this.handleSubmit,className:"accountform"},r.a.createElement("div",{className:"errormessage"},this.state.error_message),r.a.createElement("label",null,"\u8d26 \u53f7\u3000",r.a.createElement("input",{type:"text",name:"mobile",onChange:this.handleChange,autoFocus:!0})),r.a.createElement("label",null,"\u5bc6 \u7801\u3000",r.a.createElement("input",{type:"password",name:"password",onChange:this.handleChange})),r.a.createElement("input",{type:"submit",value:"\u767b \u9646",className:"accountbutton"})))}},{key:"componentDidUpdate",value:function(){if(this.state.loading){var e=!0,t=!1,a=void 0;try{for(var n,r=document.forms[0].elements[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){n.value.disabled=!0}}catch(dt){t=!0,a=dt}finally{try{e||null==r.return||r.return()}finally{if(t)throw a}}}else if(document.forms[0].elements[0].disabled){var l=!0,s=!1,i=void 0;try{for(var o,c=document.forms[0].elements[Symbol.iterator]();!(l=(o=c.next()).done);l=!0){o.value.disabled=!1}}catch(dt){s=!0,i=dt}finally{try{l||null==c.return||c.return()}finally{if(s)throw i}}}}}]),t}(r.a.Component),Je=Object(U.b)(function(e){return{loading:e.UI.loading,errors:e.UI.errors}},Ge)(Xe),He={logout:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){t({type:"SET_OFFLINE"}),Q(),t({type:"REMOVE_USER_NAME"}),t({type:"SET_MUSIC_INFO",payload:e.MusicInfo}),t({type:"SET_USER_INFO",payload:e.UserInfo})}},createPlaylist:x,deletePlaylist:function(e){return function(t){console.dir(e),t({type:"DELETE_PLAYLIST",payload:e})}},deleteMusicFromPlaylist:G,setCurrentPlayList:$},qe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleClidk=function(e){var t=null;if(window.localStorage.MusicApp)try{t=M.a.verify(window.localStorage.MusicApp,"MusicApp").body.stores.offline||{}}catch(dt){console.dir(dt)}a.props.logout(t),a.setState({loggedout:!0})},a.handleCreatePlaylist=function(e){if(a.props.userName){var t=window.prompt("\u540d\u79f0");if(a.props.myPlaylists.hasOwnProperty(t))alert("\u8be5\u5217\u8868\u540d\u79f0\u5df2\u5b58\u5728");else{if(!t)return;a.props.createPlaylist(t)}}else alert("\u8bf7\u5148\u767b\u5f55")},a.handleDeletePlaylist=function(e){var t=e.target.parentNode.dataset.playlistname;window.confirm("\u662f\u5426\u8981\u5220\u9664\u5217\u8868"+t)&&(a.props.myPlaylists.hasOwnProperty(t)?"\u6700\u8fd1\u64ad\u653e"!==t?(a.props.currentPlayList===t&&a.props.setCurrentPlayList("\u6700\u8fd1\u64ad\u653e"),a.props.deletePlaylist(t)):alert("\u65e0\u6cd5\u5220\u9664\u9ed8\u8ba4\u5217\u8868"):alert("\u5220\u9664\u5931\u8d25"))},a.handleDeleteMusicFromPlaylist=function(e){e.stopPropagation();var t=a.props.myPlaylists[a.state.currentPlaylist].find(function(t){return t.url===e.target.dataset.url});a.props.deleteMusicFromPlaylist(t,a.state.currentPlaylist)},a.handleViewPlaylist=function(e){e.stopPropagation(),a.setState({showPlaylist:!0,currentPlaylist:e.target.textContent})},a.handleHidePlaylist=function(e){a.setState({showPlaylist:!1})},a.state={showPlaylist:!1,currentPlaylist:"\u6700\u8fd1\u64ad\u653e",loggedout:!1},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.props.userName&&r.a.createElement("div",{className:"accountopration"},r.a.createElement("div",null,"\u6b22\u8fce\uff0c",this.props.userName),r.a.createElement("button",{onClick:this.handleCreatePlaylist},"\u521b\u5efa\u64ad\u653e\u5217\u8868"),r.a.createElement("button",{onClick:this.handleClidk},"\u9000\u51fa\u767b\u9646")),this.state.showPlaylist?r.a.createElement("div",{style:{paddingTop:"20px"}},r.a.createElement("div",{className:"buttongroup"},r.a.createElement("button",{onClick:this.handleHidePlaylist},"<\u8fd4\u56de"),r.a.createElement("div",null,this.state.currentPlaylist)),r.a.createElement(le,{commonLists:this.props.myPlaylists,currentNav:this.state.currentPlaylist,type:"DELETE",handleDeleteMusicFromPlaylist:this.handleDeleteMusicFromPlaylist})):r.a.createElement(pe,{myPlaylists:this.props.myPlaylists,handleDeletePlaylist:this.handleDeletePlaylist,handleViewPlaylist:this.handleViewPlaylist,type:"VIEW"}))}},{key:"componentDidUpdate",value:function(){this.state.loggedout&&document.querySelector("audio").pause()}}]),t}(n.Component),We=Object(U.b)(function(e){return{myPlaylists:e.MusicInfo.myPlaylists,userName:e.UserInfo.userName,currentPlayList:e.UserInfo.currentPlayList}},He)(qe),Be={login:Z},ze=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){a.setState({loading:!0}),e.preventDefault();var t=new FormData;t.append("apikey","84fa40e600ae8a00c47eaf282d3bda46"),t.append("passwd",a.state.password),t.append("name",a.state.mobile),V.a.post("https://api.apiopen.top/registerUser",t).then(function(e){200===e.data.code?a.props.login(e.data.result.name):a.setState({error_message:e.data.message,loading:!1})}).catch(function(e){return console.dir(e)})},a.handleChange=function(e){var t;a.setState((t={},Object(h.a)(t,e.target.name,e.target.value),Object(h.a)(t,"error_message",""),t))},a.state={mobile:"",password:"",error_message:"",loading:!1},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"accountopration"},r.a.createElement(A.c,{to:"/my/collection"},"<\u8fd4\u56de"),r.a.createElement("div",null,"\u6ce8\u518c")),r.a.createElement("form",{onSubmit:this.handleSubmit,className:"accountform"},r.a.createElement("div",{className:"errormessage"},this.state.error_message),r.a.createElement("label",null,"\u8d26 \u53f7\u3000",r.a.createElement("input",{type:"text",name:"mobile",onChange:this.handleChange,autoFocus:!0})),r.a.createElement("label",null,"\u5bc6 \u7801\u3000",r.a.createElement("input",{type:"password",name:"password",onChange:this.handleChange})),r.a.createElement("input",{type:"submit",value:"\u6ce8 \u518c",className:"accountbutton"})))}},{key:"componentDidUpdate",value:function(){if(this.state.loading){var e=!0,t=!1,a=void 0;try{for(var n,r=document.forms[0].elements[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){n.value.disabled=!0}}catch(dt){t=!0,a=dt}finally{try{e||null==r.return||r.return()}finally{if(t)throw a}}}else if(document.forms[0].elements[0].disabled){var l=!0,s=!1,i=void 0;try{for(var o,c=document.forms[0].elements[Symbol.iterator]();!(l=(o=c.next()).done);l=!0){o.value.disabled=!1}}catch(dt){s=!0,i=dt}finally{try{l||null==c.return||c.return()}finally{if(s)throw i}}}}}]),t}(r.a.Component),Ke=Object(U.b)(function(e){return{loading:e.UI.loading,errors:e.UI.errors}},Be)(ze),Qe={createPlaylist:x},Ze=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleCreatePlaylist=function(e){if(a.props.userName){var t=window.prompt("\u540d\u79f0");if(a.props.myPlaylists.hasOwnProperty(t))alert("\u8be5\u5217\u8868\u540d\u79f0\u5df2\u5b58\u5728");else{if(!t)return;a.props.createPlaylist(t)}}else alert("\u8bf7\u5148\u767b\u5f55")},a.state={},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,!this.props.userName&&"/my/collection"===this.props.location.pathname&&r.a.createElement("div",{className:"accountopration"},r.a.createElement(A.c,{to:"/my/login"},"\u767b\u9646"),r.a.createElement(A.c,{to:"/my/register"},"\u6ce8\u518c"),r.a.createElement("button",{onClick:this.handleCreatePlaylist},"\u521b\u5efa\u64ad\u653e\u5217\u8868")),r.a.createElement(R.b,{path:"/my/login",component:Je}),r.a.createElement(R.b,{path:"/my/register",component:Ke}),r.a.createElement(R.b,{path:"/my/collection",component:We}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.userName?"/my"!==e.location.pathname&&"/my/collection"===e.location.pathname||e.history.replace("/my/collection",null):"/my"===e.location.pathname&&e.history.replace("/my/collection",null),null}}]),t}(n.Component),$e=Object(U.b)(function(e){return{myPlaylists:e.MusicInfo.myPlaylists,userName:e.UserInfo.userName}},Qe)(Object(R.g)(Ze)),et=a(281),tt=a(282),at=a(139),nt=a.n(at),rt=a(138),lt=a.n(rt),st=a(140),it=a.n(st),ot=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e,t){a.setState({value:t})};var n=a.props.location.pathname.match(/^\/(\w+)\/?/);return a.state={value:n?n[1]:"list"},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"bottom-nav"},r.a.createElement(et.a,{showLabels:!0,value:this.state.value,onChange:this.handleChange},r.a.createElement(tt.a,{component:A.b,to:"/list/"+this.props.currentNav,value:"list",label:"\u63a8\u8350",icon:r.a.createElement(lt.a,null)}),r.a.createElement(tt.a,{component:A.b,to:"/play",value:"play",label:"\u64ad\u653e",icon:r.a.createElement(nt.a,null)}),r.a.createElement(tt.a,{component:A.b,to:"/my",value:"my",label:"\u6536\u85cf",icon:r.a.createElement(it.a,null)})))}}]),t}(n.Component),ct=Object(U.b)(function(e){return{currentNav:e.UserInfo.currentNav||"\u70ed\u6b4c\u699c"}},null)(Object(R.g)(ot)),ut={setCurrentPlaying:ee,setMusicDuration:function(e){return function(t){t({type:"SET_MUSIC_DURATION",payload:e})}}},pt=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleEnded=function(e){switch(a.props.currentPlayMode){case"loop":a.props.forwardRef.current.currentTime=0,a.props.forwardRef.current.play();break;case"list":var t=a.props.myPlaylists[a.props.currentPlayList],n=t.findIndex(function(e){return e.url===a.props.currentPlaying.url});a.props.setCurrentPlaying(t[(n+1)%t.length]),n===(n+1)%t.length&&(a.props.forwardRef.current.currentTime=0,a.props.forwardRef.current.play());break;case"random":var r=a.props.myPlaylists[a.props.currentPlayList],l=Math.floor(Math.random()*r.length);a.props.setCurrentPlaying(r[l]),a.props.forwardRef.current.play()}},a.setMusicDuration=function(e){a.props.setMusicDuration(e.target.duration)},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("audio",{autoPlay:!0,onLoadedData:this.setMusicDuration,preload:"true",ref:this.props.forwardRef,src:this.props.currentPlaying.url})}},{key:"componentDidMount",value:function(){this.props.forwardRef.current.pause(),this.props.forwardRef.current.addEventListener("ended",this.handleEnded)}}]),t}(n.Component),mt=(K=Object(U.b)(function(e){return{currentPlaying:e.UserInfo.currentPlaying,currentPlayMode:e.UserInfo.currentPlayMode,myPlaylists:e.MusicInfo.myPlaylists,currentPlayList:e.UserInfo.currentPlayList}},ut)(pt),r.a.forwardRef(function(e,t){return r.a.createElement(K,Object.assign({},e,{forwardRef:t}))})),yt=function(e){function t(e){var a;return Object(i.a)(this,t),a=Object(c.a)(this,Object(u.a)(t).call(this,e)),window.onbeforeunload=function(){Q()},a.audio=r.a.createRef(),a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(U.a,{store:D},r.a.createElement(A.a,null,r.a.createElement(mt,{ref:this.audio}),r.a.createElement(R.d,null,r.a.createElement(R.b,{path:"/list",component:Ee}),r.a.createElement(R.b,{path:"/play",render:function(){return r.a.createElement(Ye,{audio:e.audio})}}),r.a.createElement(R.b,{path:"/my",component:$e}),r.a.createElement(R.a,{to:"/list/\u70ed\u6b4c\u699c"})),r.a.createElement(ct,null)))}}]),t}(r.a.Component);s.a.render(r.a.createElement(yt,null),document.getElementById("root"))}},[[142,1,2]]]);
//# sourceMappingURL=main.564dde35.chunk.js.map